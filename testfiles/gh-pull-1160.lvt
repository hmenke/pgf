\documentclass{minimal}
\input{pgf-regression-test}

\RequirePackage{tikz}

\begin{document}

\START

\def\myspecialsauce{\node{specialsauce}}

\protected\long\def\ASSERTEQUAL{%
  \ifx#1#2\TRUE\else\FALSE\fi
}
\let\UNDEFINED\undefined
\def\specialsauceOUTER{outer definition}


\BEGINTEST{\tikzaddtikzonlycommandshortcutlet, undefined}
  \tikzaddtikzonlycommandshortcutlet{\specialsauce}{\myspecialsauce}
  \begin{tikzpicture}
    \specialsauce;
    \node at (0,1) {\ASSERTEQUAL\specialsauce\UNDEFINED};
  \end{tikzpicture}
\ENDTEST

\BEGINTEST{\tikzaddtikzonlycommandshortcutlet, defined}
  \let\specialsauce\specialsauceOUTER
  \tikzaddtikzonlycommandshortcutlet{\specialsauce}{\myspecialsauce}
  \begin{tikzpicture}
    \specialsauce;
    \node at (0,1) {\ASSERTEQUAL\specialsauce\specialsauceOUTER};
  \end{tikzpicture}
\ENDTEST

\BEGINTEST{\tikzaddtikzonlycommandshortcutdef, undefined}
  \tikzaddtikzonlycommandshortcutdef{\specialsauce}{\myspecialsauce}
  \begin{tikzpicture}
    \specialsauce;
    \node at (0,1) {\ASSERTEQUAL\specialsauce\UNDEFINED};
  \end{tikzpicture}
\ENDTEST

\BEGINTEST{\tikzaddtikzonlycommandshortcutdef, defined}
  \let\specialsauce\specialsauceOUTER
  \tikzaddtikzonlycommandshortcutdef{\specialsauce}{\myspecialsauce}
  \begin{tikzpicture}
    \specialsauce;
    \node at (0,1) {\ASSERTEQUAL\specialsauce\specialsauceOUTER};
  \end{tikzpicture}
\ENDTEST

\END
